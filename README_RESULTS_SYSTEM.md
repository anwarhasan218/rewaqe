# دليل استخدام نظام النتائج المحدث

## 🎯 نظرة عامة
تم إصلاح جميع المشاكل في نظام النتائج وهو الآن جاهز للاستخدام بشكل كامل ومتسق.

## ✅ ما تم إصلاحه

### 1. **خيارات النتائج المتاحة**
النظام يدعم الآن جميع حالات النتائج التالية:
- **ناجح** - للطلاب الناجحين في جميع المواد
- **ناجح ومنقول** - للطلاب الناجحين والمنتقلين للمستوى التالي
- **ناجح بمواد** - للطلاب الناجحين مع وجود مواد متعثر فيها (أقل من 3 مواد)
- **منقول بمواد** - للطلاب المنقولين مع مواد متبقية
- **راسب** - للطلاب الراسبين في أكثر من مادتين
- **باقي للإعادة** - للطلاب الذين يحتاجون إعادة السنة
- **غائب** - للطلاب الغائبين عن الامتحانات

### 2. **الحقول المتوفرة**
#### نموذج النتيجة النهائية (StudentResult):
- `student` - الطالب
- `level` - المستوى الدراسي
- `batch` - الدفعة
- `result` - النتيجة النهائية
- `failed_courses` - المواد المتعثر فيها
- `academic_year` - العام الدراسي
- `total_score` - المجموع الكلي للدرجات
- `result_date` - تاريخ إعلان النتيجة

#### نموذج نتيجة المادة (CourseResult):
- `student` - الطالب
- `course` - المادة
- `score` - الدرجة
- `batch` - الدفعة
- `academic_year` - العام الدراسي

## 🚀 كيفية استخدام النظام

### 1. **إنشاء النتائج النهائية**
1. اذهب إلى **النتائج النهائية** من القائمة الرئيسية
2. اضغط على **إنشاء النتائج النهائية**
3. اختر:
   - الدفعة
   - المستوى
   - العام الدراسي
4. اضغط **إنشاء النتائج**

### 2. **رفع درجات المواد بالجملة**
1. اذهب إلى **رفع النتائج بالجملة**
2. اختر المرحلة والمستوى والعام الدراسي
3. اضغط **تصدير نموذج** لتحميل ملف Excel فارغ
4. املأ الدرجات في الملف
5. ارفع الملف واضغط **رفع النتائج**

### 3. **عرض وتصفية النتائج**
1. في صفحة **النتائج النهائية** يمكنك:
   - تصفية حسب المستوى
   - تصفية حسب العام الدراسي
   - تصفية حسب الدفعة
   - تصفية حسب حالة النتيجة
   - البحث باسم أو كود الطالب

### 4. **تصدير النتائج**
- **كشف نتائج مستوى كامل**: اختر المستوى والعام الدراسي ثم اضغط **تصدير كشف النتائج**
- **كشف درجات طالب واحد**: اضغط **كشف درجات** بجانب اسم الطالب

## 📊 منطق تحديد النتائج

النظام يحدد النتيجة النهائية تلقائياً حسب القواعد التالية:

```
إذا كان الطالب غائب في أي مادة → غائب
إذا لم يرسب في أي مادة → ناجح ومنقول  
إذا رسب في مادتين أو أقل → ناجح بمواد
إذا رسب في أكثر من مادتين → راسب
```

## 🎨 ألوان النتائج في الواجهة

- **أخضر**: ناجح، ناجح ومنقول
- **أصفر**: ناجح بمواد، منقول بمواد
- **أحمر**: راسب، باقي للإعادة، غائب

## 📁 ملفات Excel المصدرة

### كشف النتائج الشامل:
- كود الطالب
- رقم الجلوس
- اسم الطالب
- درجات جميع المواد
- المجموع الكلي
- النتيجة النهائية
- المواد المتعثر فيها (إن وجدت)

### كشف درجات الطالب:
- بيانات الطالب الشخصية
- درجات جميع المواد مع حالة النجاح/الرسوب
- المجموع الكلي والنسبة المئوية
- النتيجة النهائية

## ⚠️ ملاحظات مهمة

1. **العام الدراسي**: يجب إدخال العام الدراسي بصيغة "2024-2025"
2. **الدرجات**: يجب أن تكون الدرجات بين 0 والدرجة النهائية للمادة
3. **الدفعات**: تأكد من تفعيل الدفعة قبل استخدامها
4. **النسخ الاحتياطي**: يُنصح بعمل نسخة احتياطية من قاعدة البيانات قبل رفع النتائج

## 🔧 استكشاف الأخطاء

### مشكلة: "الطالب غير موجود"
- تأكد من صحة كود الطالب في ملف Excel
- تأكد من أن الطالب مسجل في النظام

### مشكلة: "المادة غير موجودة"
- تأكد من صحة اسم المادة في ملف Excel
- تأكد من أن المادة مضافة للمستوى المحدد

### مشكلة: "درجة غير صحيحة"
- تأكد من أن الدرجة رقم صحيح
- تأكد من أن الدرجة لا تتجاوز الدرجة النهائية للمادة

## 📞 الدعم الفني

في حالة وجود أي مشاكل أو استفسارات، يرجى:
1. التحقق من ملف `FIXES_SUMMARY.md` للتفاصيل التقنية
2. مراجعة هذا الدليل
3. التواصل مع المطور

---
**تم التحديث:** مايو 2025  
**الإصدار:** 2.0 (بعد الإصلاحات)
